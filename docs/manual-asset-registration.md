# 수동 자산 등록 설계 제안

현재 시스템은 거래소 및 증권사 API를 통해 자산 정보를 자동으로 동기화합니다. 그러나 모든 플랫폼이 공개 API를 제공하는 것은 아니며, 자산 변동이 거의 없는 경우 자동 동기화를 굳이 구성할 필요가 없습니다. 이러한 상황을 지원하기 위해 사용자가 직접 자산을 등록하고 관리할 수 있는 수동 입력 기능을 제안합니다.

## 도입 배경
- 거래소 연동이 어렵거나 공개 API가 없는 플랫폼
- 장기 보유 자산처럼 시세 변화가 적어 빈번한 동기화가 불필요한 경우
- 초기 이관 작업에서 CSV 또는 수기 입력이 필요한 경우

## 요구 사항
1. **입력 경로**
   - Streamlit 기반 UI에서 자산 정보를 직접 입력
2. **필드 예시**
   - `name`, `symbol`, `category`
   - `platform_name` (예: "수동등록"), 미존재 시 `Platform` 테이블에 생성
   - `quantity`, `avg_price` 또는 `evaluation_amount`
   - `currency` (선택), 제공 시 환율 정보를 활용해 `eval_amount_krw` 계산
3. **데이터 처리**
   - 입력된 자산은 기존 `Asset` 모델로 저장하며 API 연동 자산과 동일하게 취급
   - `platform_name`이 존재하지 않으면 `Platform` 테이블에 레코드를 생성
   - `create_asset`, `update_asset`, `delete_asset` 함수를 사용해 생성·수정·삭제 수행
   - 필수 필드를 검증하고, 오류 발생 시 Streamlit에 피드백을 표시
   - 수정 이력이나 버전 관리는 현재 단계에서는 고려하지 않음
4. **가격 산정**
   - 실시간 가격을 제공하지 않는 플랫폼이므로 사용자가 직접 가격을 입력
   - `avg_price`와 `quantity`가 제공되면 `evaluation_amount`를 계산
   - 환율 변환은 기존 `ExchangeRate` 및 `calculate_eval_amount_krw` 로직을 재사용

## 구현 세부 사항
1. **Streamlit UI 구성**
   - `1_자산현황.py`에서 보유 자산 목록을 표로 상단에 표시
   - 페이지 **하단**에 `st.form`을 배치하여 신규 자산 입력 및 기존 자산 수정
   - 각 표 행에 "수정"과 "삭제" 버튼을 두어 CRUD 처리를 수행
2. **동작 흐름 요약**
   - 페이지 로드시 `Asset` 목록을 불러와 표시
   - 새 자산 입력 → 검증 → 생성
   - 목록에서 자산 선택 후 수정 → 검증 → 갱신
   - 삭제 요청 → `delete_asset` 실행 → 목록 갱신

## 기타 고려 사항

- 수동으로 등록된 자산도 `Asset` 모델로 저장되므로 다른 페이지나 기능은 추가 수정 없이 자동으로 반영됩니다.

수동 등록 기능을 도입함으로써 외부 연동의 제약을 받지 않고 유연하게 자산을 관리할 수 있습니다.
